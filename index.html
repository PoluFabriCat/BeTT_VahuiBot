<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1,user-scalable=no" />
  <meta name="theme-color" content="#ff5a7a" />
  <title>–î–ª—è –î–∂–∞–º—ã üíå</title>
  <style>
    :root{
      --bg0:#0b0c12;
      --bg1:#101322;
      --card:#14172a;
      --card2:#0f1222;
      --txt:#f6f6fb;
      --mut:#b7b7d8;
      --pink:#ff5a7a;
      --pink2:#ff93a6;
      --red:#ff2f55;
      --line:rgba(255,255,255,.08);
      --shadow: rgba(0,0,0,.35);
      --radius: 18px;
      --radius2: 24px;
      --tap: rgba(255,90,122,.15);
      --safeT: env(safe-area-inset-top,0px);
      --safeB: env(safe-area-inset-bottom,0px);
      --safeL: env(safe-area-inset-left,0px);
      --safeR: env(safe-area-inset-right,0px);
    }

    *{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    html,body{ height:100%; margin:0; background: radial-gradient(120% 120% at 20% 10%, #1a1430 0%, var(--bg0) 55%, #07070b 100%); color:var(--txt); font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji"; }
    body{ overflow:hidden; }

    /* ===== App Layout ===== */
    #app{
      position:fixed; inset:0;
      padding: calc(14px + var(--safeT)) calc(14px + var(--safeR)) calc(14px + var(--safeB)) calc(14px + var(--safeL));
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .stage{
      position:relative;
      width:min(520px, 100%);
      height:min(940px, 100%);
      max-height: 100%;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: linear-gradient(180deg, rgba(255,255,255,.05) 0%, rgba(255,255,255,.02) 100%);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      box-shadow: 0 10px 40px var(--shadow);
      overflow:hidden;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #fff 0%, var(--pink) 35%, rgba(255,90,122,.0) 70%);
      box-shadow: 0 0 14px rgba(255,90,122,.45);
      flex:0 0 auto;
    }
    .brand h1{
      margin:0;
      font-size:14px;
      letter-spacing:.2px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      font-weight:650;
    }
    .brand span{
      display:block;
      margin-top:1px;
      font-size:12px;
      color:var(--mut);
      font-weight:500;
    }
    .mini{
      display:flex; align-items:center; gap:8px;
    }

    .pill{
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color:var(--mut);
      font-size:12px;
      display:flex; align-items:center; gap:6px;
      user-select:none;
      -webkit-user-select:none;
    }
    .pill .ic{ width:14px; height:14px; display:inline-block; opacity:.85; }
    .pill strong{ color:var(--txt); font-weight:650; }

    /* ===== Scene Container ===== */
    .viewport{
      position:relative;
      flex: 1 1 auto;
      border-radius: var(--radius2);
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.03) 0%, rgba(255,255,255,.015) 70%, rgba(255,255,255,.01) 100%);
      overflow:hidden;
      box-shadow: 0 20px 60px var(--shadow);
      transform: translateZ(0);
    }

    .scene{
      position:absolute; inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
      opacity:0;
      transform: translate3d(0, 10px, 0);
      pointer-events:none;
      transition: opacity 360ms ease, transform 360ms ease;
      will-change: opacity, transform;
    }
    .scene.active{
      opacity:1;
      transform: translate3d(0,0,0);
      pointer-events:auto;
    }

    /* ===== Cards / UI ===== */
    .card{
      width:100%;
      max-width: 460px;
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: linear-gradient(180deg, rgba(20,23,42,.78) 0%, rgba(14,16,30,.78) 100%);
      box-shadow: 0 18px 50px rgba(0,0,0,.35);
      overflow:hidden;
      transform: translateZ(0);
    }
    .card .hd{
      padding:14px 14px 10px 14px;
      border-bottom:1px solid rgba(255,255,255,.06);
      display:flex;
      gap:12px;
      align-items:center;
    }
    .avatar{
      width:44px; height:44px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(circle at 35% 35%, rgba(255,255,255,.25) 0%, rgba(255,255,255,0) 55%),
        linear-gradient(135deg, rgba(255,90,122,.35), rgba(255,147,166,.15));
      box-shadow: 0 0 0 6px rgba(255,90,122,.06);
      flex:0 0 auto;
      position:relative;
      overflow:hidden;
    }
    .avatar:before{
      content:"";
      position:absolute; inset:-40%;
      background: repeating-linear-gradient(90deg, rgba(255,255,255,.06) 0 2px, rgba(255,255,255,0) 2px 8px);
      transform: rotate(8deg);
      opacity:.6;
    }
    .hd .t{
      min-width:0;
    }
    .hd .t .name{
      font-weight:700; font-size:14px; margin:0;
    }
    .hd .t .sub{
      margin-top:2px;
      font-size:12px; color:var(--mut);
    }

    .card .bd{
      padding:14px;
    }
    .say{
      margin:0 0 10px 0;
      font-size:16px;
      line-height:1.35;
      font-weight:650;
      letter-spacing:.2px;
    }
    .hint{
      margin:0;
      color:var(--mut);
      font-size:13px;
      line-height:1.35;
    }

    .actions{
      margin-top:14px;
      display:flex;
      gap:10px;
    }
    .btn{
      appearance:none;
      border:none;
      border-radius: 14px;
      padding:12px 12px;
      font-size:14px;
      font-weight:700;
      color:var(--txt);
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      width:100%;
      min-height:44px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      user-select:none;
      -webkit-user-select:none;
      transform: translateZ(0);
      transition: transform 120ms ease, background 180ms ease, border-color 180ms ease, opacity 180ms ease;
    }
    .btn:active{ transform: scale(.98); }
    .btn.primary{
      background: linear-gradient(180deg, rgba(255,90,122,.92), rgba(255,47,85,.86));
      border-color: rgba(255,255,255,.16);
      box-shadow: 0 10px 30px rgba(255,47,85,.25);
    }
    .btn.ghost{
      background: rgba(255,255,255,.035);
    }
    .btn.disabled{
      opacity:.45;
      pointer-events:none;
    }

    .toast{
      position:absolute;
      left:50%;
      top:14px;
      transform: translate3d(-50%, -10px, 0);
      opacity:0;
      padding:10px 12px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,11,18,.70);
      color:var(--txt);
      font-size:13px;
      box-shadow: 0 16px 40px rgba(0,0,0,.35);
      transition: opacity 220ms ease, transform 220ms ease;
      pointer-events:none;
      white-space:nowrap;
      max-width: calc(100% - 28px);
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .toast.on{
      opacity:1;
      transform: translate3d(-50%, 0, 0);
    }

    /* ===== Pixel-ish CRT overlay (subtle) ===== */
    .crt{
      position:absolute; inset:0;
      pointer-events:none;
      mix-blend-mode: overlay;
      opacity:.18;
      background:
        repeating-linear-gradient(
          180deg,
          rgba(255,255,255,.07) 0px,
          rgba(255,255,255,.00) 2px,
          rgba(255,255,255,.00) 4px
        );
      transform: translateZ(0);
    }
    .noise{
      position:absolute; inset:-20%;
      pointer-events:none;
      opacity:.08;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='120' height='120' filter='url(%23n)' opacity='.8'/%3E%3C/svg%3E");
      background-size: 240px 240px;
      animation: jitter 4.5s linear infinite;
      transform: translateZ(0);
    }
    @keyframes jitter{
      0%{ transform: translate3d(0,0,0) }
      25%{ transform: translate3d(-2%,1%,0) }
      50%{ transform: translate3d(1%,-2%,0) }
      75%{ transform: translate3d(2%,2%,0) }
      100%{ transform: translate3d(0,0,0) }
    }

    /* ===== Particles Canvas ===== */
    #fx{
      position:absolute; inset:0;
      pointer-events:none;
      transform: translateZ(0);
    }

    /* ===== Preloader ===== */
    #preloader{
      position:fixed; inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 18px;
      background: radial-gradient(120% 120% at 50% 20%, #20123a 0%, #0b0c12 60%, #07070b 100%);
      z-index:50;
    }
    .loadbox{
      width:min(520px, 100%);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 26px;
      background: linear-gradient(180deg, rgba(255,255,255,.05) 0%, rgba(255,255,255,.02) 100%);
      box-shadow: 0 22px 70px rgba(0,0,0,.45);
      padding:18px 16px;
      overflow:hidden;
    }
    .loadtitle{
      font-weight:800;
      letter-spacing:.2px;
      margin:0 0 6px 0;
      font-size:16px;
    }
    .loadsub{
      margin:0 0 14px 0;
      font-size:13px;
      color:var(--mut);
      line-height:1.35;
    }
    .progress{
      height:12px;
      border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
      position:relative;
    }
    .bar{
      position:absolute; inset:0;
      width: 0%;
      background: linear-gradient(90deg, rgba(255,90,122,.25), rgba(255,90,122,.92), rgba(255,147,166,.55));
      transform: translateZ(0);
      border-radius:999px;
      transition: width 220ms ease;
    }
    .dots{
      margin-top:10px;
      font-size:13px;
      color:var(--mut);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .dots span{
      display:inline-flex;
      gap:3px;
      align-items:center;
    }
    .dots i{
      display:inline-block;
      width:6px; height:6px; border-radius:999px;
      background: rgba(255,255,255,.18);
      animation: blink 1.1s infinite;
      transform: translateZ(0);
    }
    .dots i:nth-child(2){ animation-delay:.15s; }
    .dots i:nth-child(3){ animation-delay:.3s; }
    @keyframes blink{
      0%, 30%{ opacity:.2; transform: translate3d(0,0,0) scale(.95); }
      55%{ opacity:1; transform: translate3d(0,0,0) scale(1.05); }
      100%{ opacity:.25; transform: translate3d(0,0,0) scale(.98); }
    }

    /* ===== 3D Object Area ===== */
    .center{
      width:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:14px;
    }
    .objectWrap{
      width: min(340px, 84vw);
      height: min(340px, 84vw);
      position:relative;
      perspective: 900px;
      transform: translateZ(0);
      touch-action:none;
      user-select:none;
      -webkit-user-select:none;
    }
    .object3d{
      width:100%;
      height:100%;
      position:absolute; inset:0;
      transform-style:preserve-3d;
      will-change: transform;
    }

    /* pixel-ish edges without heavy filters */
    .pixEdge{
      position:absolute; inset:-2px;
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.10);
      background:
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0) 60%),
        repeating-linear-gradient(90deg, rgba(255,255,255,.05) 0 2px, rgba(255,255,255,0) 2px 6px);
      opacity:.30;
      pointer-events:none;
      transform: translateZ(0);
    }

    /* ===== Box Model (simple CSS 3D) ===== */
    .box{
      position:absolute; inset:0;
      transform-style:preserve-3d;
    }
    .face{
      position:absolute;
      left:50%; top:50%;
      transform-style:preserve-3d;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      overflow:hidden;
    }

    /* keep it light: no big blur, only small highlights */
    .face:before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(circle at 25% 20%, rgba(255,255,255,.18), rgba(255,255,255,0) 60%),
        repeating-linear-gradient(135deg, rgba(255,255,255,.06) 0 2px, rgba(255,255,255,0) 2px 9px);
      opacity:.65;
      pointer-events:none;
    }
    .face .label{
      position:absolute;
      left:14px; right:14px;
      bottom:14px;
      padding:10px 12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,11,18,.38);
      font-size:14px;
      font-weight:800;
      letter-spacing:.3px;
      text-align:center;
    }
    .face .label small{
      display:block;
      margin-top:4px;
      font-weight:650;
      font-size:12px;
      color:rgba(255,255,255,.78);
      letter-spacing:.2px;
    }

    /* box dimensions */
    .box .front{ width: 250px; height: 190px; transform: translate3d(-50%, -50%, 60px); }
    .box .back { width: 250px; height: 190px; transform: translate3d(-50%, -50%, -60px) rotateY(180deg); }
    .box .right{ width: 120px; height: 190px; transform: translate3d(-50%, -50%, 0) rotateY(90deg) translateZ(125px); transform-origin:center; }
    .box .left { width: 120px; height: 190px; transform: translate3d(-50%, -50%, 0) rotateY(-90deg) translateZ(125px); transform-origin:center; }
    .box .top  { width: 250px; height: 120px; transform: translate3d(-50%, -50%, 0) rotateX(90deg) translateZ(95px); transform-origin:center; }
    .box .bot  { width: 250px; height: 120px; transform: translate3d(-50%, -50%, 0) rotateX(-90deg) translateZ(95px); transform-origin:center; }

    .box .front{
      background:
        linear-gradient(180deg, rgba(255,90,122,.12), rgba(255,255,255,.02)),
        linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,0) 60%),
        rgba(20,23,42,.35);
    }

    /* Lock */
    .lock{
      position:absolute;
      left:50%;
      top:50%;
      width:78px;
      height:86px;
      transform: translate3d(-50%, -30%, 84px);
      transform-style:preserve-3d;
      cursor:pointer;
    }
    .lock .body{
      position:absolute; inset:0;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.03));
      box-shadow: 0 0 0 6px rgba(255,90,122,.08);
      overflow:hidden;
    }
    .lock .body:before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(circle at 30% 25%, rgba(255,255,255,.20), rgba(255,255,255,0) 60%),
        repeating-linear-gradient(90deg, rgba(255,255,255,.06) 0 2px, rgba(255,255,255,0) 2px 7px);
      opacity:.75;
    }
    .lock .hole{
      position:absolute;
      left:50%;
      top:44%;
      width:16px;
      height:22px;
      border-radius: 10px;
      background: rgba(10,11,18,.75);
      border:1px solid rgba(255,255,255,.10);
      transform: translate3d(-50%,-50%,2px);
    }
    .lock .shackle{
      position:absolute;
      left:50%;
      top:-18px;
      width:60px;
      height:46px;
      border-radius: 999px;
      border:10px solid rgba(255,255,255,.15);
      border-bottom: 0;
      transform: translate3d(-50%,0,1px);
      filter:none;
      opacity:.9;
    }
    .lockPulse{
      position:absolute; inset:-14px;
      border-radius: 28px;
      border:1px solid rgba(255,90,122,.35);
      box-shadow: 0 0 24px rgba(255,90,122,.22);
      animation: pulse 1.35s ease-in-out infinite;
      pointer-events:none;
    }
    @keyframes pulse{
      0%,100%{ transform: scale(.98); opacity:.55; }
      50%{ transform: scale(1.04); opacity:1; }
    }

    /* ===== Envelope Model ===== */
    .env{
      position:absolute; inset:0;
      transform-style:preserve-3d;
    }
    .env .plate{
      position:absolute;
      left:50%; top:50%;
      width: 270px; height: 180px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background:
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)),
        linear-gradient(135deg, rgba(255,90,122,.10), rgba(255,147,166,.06)),
        rgba(20,23,42,.38);
      transform: translate3d(-50%,-50%,40px);
      overflow:hidden;
    }
    .env .plate:before{
      content:"";
      position:absolute; inset:0;
      background:
        repeating-linear-gradient(90deg, rgba(255,255,255,.06) 0 2px, rgba(255,255,255,0) 2px 8px),
        radial-gradient(circle at 30% 20%, rgba(255,255,255,.18), rgba(255,255,255,0) 60%);
      opacity:.7;
      pointer-events:none;
    }
    .env .flap{
      position:absolute;
      left:50%; top:50%;
      width: 270px; height: 180px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background:
        linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.01)),
        rgba(14,16,30,.35);
      transform-origin: 50% 40%;
      transform: translate3d(-50%,-50%,41px) rotateX(-18deg);
      clip-path: polygon(0 0, 100% 0, 50% 58%);
      opacity:.85;
    }
    .seal{
      position:absolute;
      left:50%;
      top:50%;
      width:68px; height:68px;
      border-radius:999px;
      transform: translate3d(-50%,-20%,60px);
      border:1px solid rgba(255,255,255,.14);
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.26), rgba(255,255,255,0) 60%),
        linear-gradient(180deg, rgba(255,90,122,.9), rgba(255,47,85,.85));
      box-shadow: 0 10px 28px rgba(255,47,85,.20);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:900;
      letter-spacing:.2px;
      user-select:none;
      -webkit-user-select:none;
    }
    .seal small{
      font-size:12px;
      opacity:.9;
      transform: translateZ(0);
    }
    .sealPulse{
      position:absolute; inset:-14px;
      border-radius:999px;
      border:1px solid rgba(255,90,122,.35);
      box-shadow: 0 0 26px rgba(255,90,122,.20);
      animation: pulse 1.35s ease-in-out infinite;
      pointer-events:none;
    }

    /* ===== Overlays (modal) ===== */
    .overlay{
      position:absolute; inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
      background: rgba(5,6,10,.55);
      opacity:0;
      pointer-events:none;
      transition: opacity 220ms ease;
      will-change: opacity;
    }
    .overlay.on{ opacity:1; pointer-events:auto; }

    .sheet{
      width: min(460px, 100%);
      border-radius: 24px;
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(20,23,42,.92) 0%, rgba(14,16,30,.92) 100%);
      box-shadow: 0 20px 70px rgba(0,0,0,.45);
      overflow:hidden;
      transform: translate3d(0, 10px, 0);
      opacity:0;
      transition: transform 260ms ease, opacity 260ms ease;
    }
    .overlay.on .sheet{ transform: translate3d(0,0,0); opacity:1; }

    .sheet .shd{
      padding:14px;
      border-bottom:1px solid rgba(255,255,255,.06);
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
    }
    .sheet .shd .ttl{
      margin:0; font-size:14px; font-weight:800;
    }
    .sheet .shd .x{
      border:none; background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      width:38px; height:38px;
      border-radius: 14px;
      color:var(--txt);
      font-weight:900;
      display:flex; align-items:center; justify-content:center;
    }
    .sheet .sbd{
      padding:14px;
    }

    /* ===== Code Lock Wheels ===== */
    .wheels{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:center;
      padding:4px 0 10px 0;
    }
    .wheel{
      width: 110px;
      height: 220px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      overflow:hidden;
      position:relative;
      touch-action:none;
      user-select:none;
      -webkit-user-select:none;
    }
    .wheel:before{
      content:"";
      position:absolute; left:0; right:0; top:0; height:34%;
      background: linear-gradient(180deg, rgba(10,11,18,.85), rgba(10,11,18,0));
      pointer-events:none;
      z-index:2;
    }
    .wheel:after{
      content:"";
      position:absolute; left:0; right:0; bottom:0; height:34%;
      background: linear-gradient(0deg, rgba(10,11,18,.85), rgba(10,11,18,0));
      pointer-events:none;
      z-index:2;
    }
    .wheel .midline{
      position:absolute; left:10px; right:10px; top:50%;
      height:56px;
      transform: translateY(-50%);
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,90,122,.10);
      z-index:1;
      pointer-events:none;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
    }
    .wheel .list{
      position:absolute; left:0; right:0; top:50%;
      transform: translate3d(0, -50%, 0);
      will-change: transform;
    }
    .wheel .item{
      height:56px;
      display:flex;
      align-items:center;
      justify-content:center;
      color:rgba(255,255,255,.75);
      font-weight:800;
      letter-spacing:.2px;
      font-size:16px;
      user-select:none;
      -webkit-user-select:none;
    }
    .wheel .item.active{
      color:var(--txt);
      text-shadow: 0 0 18px rgba(255,90,122,.18);
    }

    /* ===== Input ===== */
    .row{
      display:flex;
      gap:10px;
      align-items:center;
      margin-top:10px;
    }
    .in{
      width:100%;
      min-height:44px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      color:var(--txt);
      padding:10px 12px;
      font-size:14px;
      outline:none;
    }
    .in::placeholder{ color: rgba(255,255,255,.45); }

    /* ===== Gallery ===== */
    .gallery{
      width:min(460px, 100%);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 24px;
      overflow:hidden;
      background: rgba(255,255,255,.02);
      position:relative;
    }
    .gimg{
      width:100%;
      aspect-ratio: 4 / 5;
      display:block;
      object-fit: cover;
      opacity:0;
      transform: scale(1.01);
      transition: opacity 520ms ease, transform 720ms ease;
      will-change: opacity, transform;
    }
    .gimg.on{
      opacity:1;
      transform: scale(1);
    }
    .gcap{
      position:absolute;
      left:12px; right:12px; bottom:12px;
      padding:10px 12px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,11,18,.55);
      font-size:13px;
      color: rgba(255,255,255,.86);
      line-height:1.3;
    }
    .gnav{
      position:absolute;
      right:10px; top:10px;
      display:flex; gap:6px;
    }
    .gdot{
      width:10px; height:10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      opacity:.9;
    }
    .gdot.on{
      background: rgba(255,90,122,.85);
      border-color: rgba(255,255,255,.18);
      box-shadow: 0 0 18px rgba(255,90,122,.30);
    }

    /* ===== Letter ===== */
    .paper{
      width:min(460px, 100%);
      border-radius: 24px;
      border:1px solid rgba(255,255,255,.12);
      background:
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03)),
        rgba(20,23,42,.55);
      overflow:hidden;
      position:relative;
    }
    .paper:before{
      content:"";
      position:absolute; inset:0;
      background:
        repeating-linear-gradient(0deg, rgba(255,255,255,.05) 0 1px, rgba(255,255,255,0) 1px 24px);
      opacity:.35;
      pointer-events:none;
    }
    .paper .pbd{
      padding:16px 16px 18px 16px;
      position:relative;
    }
    .paper .title{
      margin:0 0 10px 0;
      font-size:14px;
      font-weight:900;
      letter-spacing:.2px;
    }
    .paper .txt{
      margin:0;
      color: rgba(255,255,255,.88);
      font-size:14px;
      line-height:1.55;
      white-space:pre-line;
    }
    .smallNote{
      margin-top:10px;
      color: rgba(255,255,255,.55);
      font-size:12px;
      line-height:1.35;
    }

    /* ===== Animations ===== */
    .shake{
      animation: shake 420ms ease;
    }
    @keyframes shake{
      0%{ transform: translate3d(0,0,0) }
      15%{ transform: translate3d(-6px, 0, 0) }
      30%{ transform: translate3d(6px, 0, 0) }
      45%{ transform: translate3d(-5px, 0, 0) }
      60%{ transform: translate3d(5px, 0, 0) }
      75%{ transform: translate3d(-3px, 0, 0) }
      100%{ transform: translate3d(0,0,0) }
    }

    .splitLeft{
      animation: splitLeft 420ms ease forwards;
    }
    @keyframes splitLeft{
      0%{ transform: translate3d(0,0,0); opacity:1 }
      100%{ transform: translate3d(-14px,0,0); opacity:0 }
    }
    .expandRight{
      animation: expandRight 520ms cubic-bezier(.22,1,.2,1) forwards;
    }
    @keyframes expandRight{
      0%{ transform: translate3d(0,0,0) scale(1); }
      100%{ transform: translate3d(0,0,0) scale(1.02); }
    }

    .pop{
      animation: pop 520ms cubic-bezier(.22,1,.2,1);
    }
    @keyframes pop{
      0%{ transform: translate3d(0,10px,0); opacity:0 }
      60%{ transform: translate3d(0,0,0); opacity:1 }
      100%{ transform: translate3d(0,0,0); opacity:1 }
    }

    /* ===== Reduced motion ===== */
    @media (prefers-reduced-motion: reduce){
      .scene{ transition:none; }
      .toast{ transition:none; }
      .bar{ transition:none; }
      .noise{ animation:none; }
      .lockPulse, .sealPulse{ animation:none; }
    }
  </style>
</head>
<body>
  <!-- Preloader -->
  <div id="preloader" aria-label="loading">
    <div class="loadbox">
      <p class="loadtitle">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</p>
      <p class="loadsub">–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞—é –º–∞–ª–µ–Ω—å–∫—É—é –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫—É –¥–ª—è –î–∂–∞–º—ã. –õ—ë–≥–∫–∞—è –≥—Ä–∞—Ñ–∏–∫–∞, –±—ã—Å—Ç—Ä—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏, –≤—Å—ë –ø–æ –∫—Ä–∞—Å–æ—Ç–µ.</p>
      <div class="progress" role="progressbar" aria-valuemin="0" aria-valuemax="100">
        <div class="bar" id="bar"></div>
      </div>
      <div class="dots">
        <span>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ —Å–≤–æ—Ä–∞—á–∏–≤–∞–π</span>
        <span aria-hidden="true"><i></i><i></i><i></i></span>
      </div>
    </div>
  </div>

  <div id="app" style="opacity:0; transition: opacity 320ms ease;">
    <div class="stage">
      <div class="topbar">
        <div class="brand">
          <div class="dot"></div>
          <div style="min-width:0">
            <h1>–ú–∏–Ω–∏-–∏–≥—Ä–∞-–≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–∞</h1>
            <span id="subline">–¥–ª—è –î–∂–∞–º—ã</span>
          </div>
        </div>
        <div class="mini">
          <button class="pill" id="soundBtn" type="button" title="–∑–≤—É–∫">
            <span class="ic" aria-hidden="true">üîà</span>
            <strong id="soundState">ON</strong>
          </button>
        </div>
      </div>

      <div class="viewport" id="viewport">
        <canvas id="fx"></canvas>
        <div class="noise"></div>
        <div class="crt"></div>
        <div class="toast" id="toast"></div>

        <!-- Scene 1 -->
        <section class="scene active" id="s1">
          <div class="card pop">
            <div class="hd">
              <div class="avatar" aria-hidden="true"></div>
              <div class="t">
                <p class="name" style="margin:0">–ö—É—Ä—å–µ—Ä</p>
                <p class="sub" id="courierLine" style="margin:0">–í–∞–º –ø–æ—Å—ã–ª–∫–∞ –æ—Ç —Ñ–∞–Ω–∞—Ç–∞ üòâ</p>
              </div>
            </div>
            <div class="bd">
              <p class="say">–ü–æ–¥–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞.</p>
              <p class="hint">–ï—Å–ª–∏ —Å–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å ‚Äî –∫–æ—Ä–æ–±–∫–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∑–¥–µ—Å—å. –ï—Å–ª–∏ –æ—Ç–∫–∞–∂–µ—Ç–µ—Å—å‚Ä¶ –Ω—É, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ üòå</p>
              <div class="actions">
                <button class="btn ghost" id="btnNo" type="button">–ù–µ—Ç</button>
                <button class="btn primary" id="btnYes" type="button">–î–∞</button>
              </div>
            </div>
          </div>
        </section>

        <!-- Scene 2 -->
        <section class="scene" id="s2">
          <div class="center" style="width:100%;">
            <div class="objectWrap" id="boxWrap" aria-label="box rotate area">
              <div class="object3d" id="boxObj">
                <div class="box" id="box3d">
                  <div class="face front">
                    <div class="label">–¥–ª—è –î–∂–∞–º—ã<small>–ø–æ—Å—ã–ª–∫–∞ –æ—Ç —Ñ–∞–Ω–∞—Ç–∞</small></div>
                  </div>
                  <div class="face back"></div>
                  <div class="face right"></div>
                  <div class="face left"></div>
                  <div class="face top"></div>
                  <div class="face bot"></div>
                </div>

                <div class="lock" id="lock" role="button" aria-label="lock">
                  <div class="lockPulse"></div>
                  <div class="shackle"></div>
                  <div class="body"></div>
                  <div class="hole"></div>
                </div>
              </div>
              <div class="pixEdge"></div>
            </div>

            <div class="card" style="max-width:460px;">
              <div class="bd">
                <p class="say" style="margin-bottom:6px;">–ü–æ–≤–µ—Ä–Ω–∏ –∫–æ—Ä–æ–±–∫—É –ø–∞–ª—å—Ü–µ–º üëÜ</p>
                <p class="hint">–ó–∞–º–æ–∫ –ø–æ–¥—Å–≤–µ—á–µ–Ω. –ù–∞–∂–º–∏ –Ω–∞ –Ω–µ–≥–æ, —á—Ç–æ–±—ã –≤–≤–µ—Å—Ç–∏ –∫–æ–¥.</p>
              </div>
            </div>
          </div>

          <!-- Code lock overlay -->
          <div class="overlay" id="codeOverlay" aria-label="code lock">
            <div class="sheet">
              <div class="shd">
                <p class="ttl" style="margin:0">–ö–æ–¥–æ–≤—ã–π –∑–∞–º–æ–∫</p>
                <button class="x" id="closeCode" type="button">‚úï</button>
              </div>
              <div class="sbd">
                <p class="hint" style="margin:0 0 10px 0;">–ü—Ä–æ–∫—Ä—É—Ç–∏ –∫–æ–ª—ë—Å–∏–∫–∏. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ ‚Äî –¥–∞—Ç–∞.</p>
                <div class="wheels" id="wheels">
                  <div class="wheel" data-wheel="day">
                    <div class="midline"></div>
                    <div class="list"></div>
                  </div>
                  <div class="wheel" data-wheel="month">
                    <div class="midline"></div>
                    <div class="list"></div>
                  </div>
                  <div class="wheel" data-wheel="year">
                    <div class="midline"></div>
                    <div class="list"></div>
                  </div>
                </div>
                <div class="actions">
                  <button class="btn ghost" id="backFromCode" type="button">–ù–∞–∑–∞–¥</button>
                  <button class="btn primary" id="doneCode" type="button">–ì–æ—Ç–æ–≤–æ</button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Scene 3 -->
        <section class="scene" id="s3">
          <div class="center" style="width:100%;">
            <div class="objectWrap" id="envWrap" aria-label="envelope rotate area">
              <div class="object3d" id="envObj">
                <div class="env" id="env3d">
                  <div class="plate"></div>
                  <div class="flap" id="envFlap"></div>
                  <div class="seal" id="seal" role="button" aria-label="seal">
                    <div class="sealPulse" id="sealPulse"></div>
                    <small>üíó</small>
                  </div>
                </div>
              </div>
              <div class="pixEdge"></div>
            </div>

            <div class="card" id="envCard" style="max-width:460px;">
              <div class="bd">
                <p class="say" style="margin-bottom:6px;">–ö–æ–Ω–≤–µ—Ä—Ç –¥–ª—è –î–∂–∞–º—ã</p>
                <p class="hint" id="envHint">–ï–≥–æ —Ç–æ–∂–µ –º–æ–∂–Ω–æ –∫—Ä—É—Ç–∏—Ç—å. –†–µ—à–∞–π: –≤—ã–±—Ä–æ—Å–∏—Ç—å –∏–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å.</p>
                <div class="actions" id="envBtns">
                  <button class="btn ghost" id="throwBtn" type="button">–í—ã–±—Ä–æ—Å–∏—Ç—å</button>
                  <button class="btn primary" id="openBtn" type="button">–û—Ç–∫—Ä—ã—Ç—å</button>
                </div>

                <div id="birthBlock" style="display:none; margin-top:10px;">
                  <p class="hint" style="margin:0 0 8px 0;">–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è —Ñ–∞–Ω–∞—Ç–∞</p>
                  <div class="row">
                    <input class="in" id="birthInput" inputmode="numeric" placeholder="01.02.2005" maxlength="10" />
                    <button class="btn primary" id="birthOk" type="button" style="width:60px; padding:12px 0;">‚úì</button>
                  </div>
                  <p class="hint" id="birthHint" style="margin-top:8px; opacity:.85;"></p>
                </div>
              </div>
            </div>

            <div id="finalBlock" style="display:none; width:100%; display:flex; flex-direction:column; align-items:center; gap:12px;">
              <div class="gallery">
                <div class="gnav" id="gDots"></div>
                <img class="gimg" id="gImg" alt="photo" />
                <div class="gcap" id="gCap">üíû</div>
              </div>

              <div class="paper">
                <div class="pbd">
                  <p class="title">–ü–∏—Å—å–º–æ (–º–æ–∂–µ—à—å –∑–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç)</p>
                  <p class="txt" id="loveText">–î–∂–∞–º–∞‚Ä¶\n\n[–¢—É—Ç —Ç–≤–æ–π —Ç–µ–∫—Å—Ç ‚Äî 6‚Äì10 —Å—Ç—Ä–æ–∫]\n\n‚Ä¢ —Å—Ç—Ä–æ–∫–∞ 1\n‚Ä¢ —Å—Ç—Ä–æ–∫–∞ 2\n‚Ä¢ —Å—Ç—Ä–æ–∫–∞ 3\n‚Ä¢ —Å—Ç—Ä–æ–∫–∞ 4\n‚Ä¢ —Å—Ç—Ä–æ–∫–∞ 5\n‚Ä¢ —Å—Ç—Ä–æ–∫–∞ 6\n\nP.S. —Ç—ã ‚Äî –º–æ–π –ª—É—á—à–∏–π —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ üíó</p>
                  <div class="smallNote">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –æ—Ç–∫—Ä–æ–π index.html –∏ –∑–∞–º–µ–Ω–∏ –±–ª–æ–∫ #loveText –Ω–∞ —Å–≤–æ–π —Ç–µ–∫—Å—Ç.</div>
                </div>
              </div>

              <div class="card" style="max-width:460px;">
                <div class="bd">
                  <p class="hint" style="margin:0">–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –¥–æ–±–∞–≤—å —Å–≤–æ–∏ —Ñ–æ—Ç–æ –≤ –ø–∞–ø–∫—É <b>Images/</b> —Ä—è–¥–æ–º —Å index.html (3‚Äì4 —à—Ç—É–∫–∏). –ò –º—É–∑—ã–∫—É <b>je-te-laisserai-des-mots.mp3</b> —Ä—è–¥–æ–º —Å index.html.</p>
                </div>
              </div>
            </div>
          </div>
        </section>

      </div>
    </div>
  </div>

  <!-- Music (user-provided file) -->
  <audio id="music" preload="auto" loop></audio>

  <script>
    (() => {
      "use strict";

      /* =======================
         Helpers
      ======================= */
      const $ = (s, el=document) => el.querySelector(s);
      const $$ = (s, el=document) => Array.from(el.querySelectorAll(s));
      const clamp = (v, a, b) => Math.max(a, Math.min(b, v));
      const lerp = (a, b, t) => a + (b - a) * t;
      const now = () => performance.now();

      // Telegram WebApp (optional)
      const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;
      if (tg) {
        try {
          tg.expand();
          tg.setHeaderColor && tg.setHeaderColor("#101322");
          tg.setBackgroundColor && tg.setBackgroundColor("#0b0c12");
        } catch (e) {}
      }

      /* =======================
         DOM
      ======================= */
      const pre = $("#preloader");
      const bar = $("#bar");
      const app = $("#app");
      const viewport = $("#viewport");
      const toast = $("#toast");

      const s1 = $("#s1");
      const s2 = $("#s2");
      const s3 = $("#s3");

      const courierLine = $("#courierLine");
      const btnNo = $("#btnNo");
      const btnYes = $("#btnYes");

      const boxWrap = $("#boxWrap");
      const boxObj  = $("#boxObj");
      const lock    = $("#lock");

      const codeOverlay = $("#codeOverlay");
      const closeCode = $("#closeCode");
      const backFromCode = $("#backFromCode");
      const doneCode = $("#doneCode");
      const wheelsEl = $("#wheels");

      const envWrap = $("#envWrap");
      const envObj  = $("#envObj");
      const envFlap = $("#envFlap");
      const seal    = $("#seal");
      const sealPulse = $("#sealPulse");
      const throwBtn = $("#throwBtn");
      const openBtn  = $("#openBtn");
      const envBtns = $("#envBtns");
      const birthBlock = $("#birthBlock");
      const birthInput = $("#birthInput");
      const birthOk = $("#birthOk");
      const birthHint = $("#birthHint");

      const finalBlock = $("#finalBlock");
      const gImg = $("#gImg");
      const gCap = $("#gCap");
      const gDots = $("#gDots");

      const soundBtn = $("#soundBtn");
      const soundState = $("#soundState");
      const music = $("#music");

      /* =======================
         Assets (Images folder + fallbacks)
         - If Images/ has nothing, we show generated SVG hearts on white background (data URI)
      ======================= */
      const FALLBACK = (txt="‚ù§") => {
        const svg =
          `<svg xmlns="http://www.w3.org/2000/svg" width="900" height="1100">
            <defs>
              <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0" stop-color="#ff93a6" stop-opacity=".28"/>
                <stop offset="1" stop-color="#ff2f55" stop-opacity=".10"/>
              </linearGradient>
            </defs>
            <rect width="100%" height="100%" fill="white"/>
            <rect x="40" y="40" width="820" height="1020" rx="56" fill="url(#g)" opacity=".25"/>
            <text x="50%" y="50%" text-anchor="middle" dominant-baseline="middle"
              font-family="system-ui, -apple-system, Segoe UI, Roboto, Arial"
              font-size="260" font-weight="900" fill="#ff2f55">${txt}</text>
            <text x="50%" y="62%" text-anchor="middle" dominant-baseline="middle"
              font-family="system-ui, -apple-system, Segoe UI, Roboto, Arial"
              font-size="44" font-weight="700" fill="#111">–¥–ª—è –î–∂–∞–º—ã</text>
          </svg>`;
        return "data:image/svg+xml;charset=UTF-8," + encodeURIComponent(svg);
      };

      // Try these filenames (you can rename your photos to match, or update this list)
      const photoCandidates = [
        "Images/1.jpg","Images/2.jpg","Images/3.jpg","Images/4.jpg",
        "Images/1.jpeg","Images/2.jpeg","Images/3.jpeg","Images/4.jpeg",
        "Images/1.png","Images/2.png","Images/3.png","Images/4.png",
        "Images/photo1.jpg","Images/photo2.jpg","Images/photo3.jpg","Images/photo4.jpg",
      ];

      // Final gallery captions (edit as you like)
      const captions = [
        "–¢—É—Ç –º—ã. –ò —ç—Ç–æ —É–∂–µ –ø–æ–≤–æ–¥ —É–ª—ã–±–∞—Ç—å—Å—è.",
        "–ü—É—Å—Ç—å –≤—Å—ë —Ö–æ—Ä–æ—à–µ–µ –±—É–¥–µ—Ç —á–∞—â–µ, —á–µ–º —Ä–µ–∂–µ.",
        "–Ø —Ä—è–¥–æ–º (–≤ –ª—é–±–æ–π –≤–µ—Ä—Å–∏–∏ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏).",
        "–î–∂–∞–º–∞, —Ç—ã ‚Äî –º–æ—è –ª—é–±–∏–º–∞—è —Å—Ü–µ–Ω–∞ üíó"
      ];

      /* =======================
         Audio: user music + tiny synth SFX (generated)
         - On iOS/Telegram, audio requires a user gesture to start.
      ======================= */
      let audioEnabled = true;
      let audioUnlocked = false;

      function setSoundUI(){
        soundState.textContent = audioEnabled ? "ON" : "OFF";
        soundBtn.querySelector(".ic").textContent = audioEnabled ? "üîà" : "üîá";
      }

      soundBtn.addEventListener("click", () => {
        audioEnabled = !audioEnabled;
        setSoundUI();
        if (!audioEnabled) {
          try { music.pause(); } catch(e){}
        } else {
          // only autoplay after unlock; otherwise wait for next user gesture
          if (audioUnlocked) safePlayMusic();
        }
      });

      function safePlayMusic(){
        if (!audioEnabled) return;
        if (!music.src) return;
        const p = music.play();
        if (p && typeof p.catch === "function") p.catch(()=>{});
      }

      // Simple WebAudio sfx
      let AC = null, master = null;
      function ensureAudio(){
        if (audioUnlocked) return;
        try{
          AC = new (window.AudioContext || window.webkitAudioContext)();
          master = AC.createGain();
          master.gain.value = 0.22; // overall low
          master.connect(AC.destination);
          audioUnlocked = true;
        }catch(e){
          audioUnlocked = false;
        }
      }
      function sfx(type="tap"){
        if (!audioEnabled) return;
        ensureAudio();
        if (!audioUnlocked || !AC) return;
        const t0 = AC.currentTime;
        const o = AC.createOscillator();
        const g = AC.createGain();

        // gentle, cute, not loud
        if (type === "tap"){
          o.type = "triangle";
          o.frequency.setValueAtTime(520, t0);
          o.frequency.exponentialRampToValueAtTime(360, t0 + 0.06);
          g.gain.setValueAtTime(0.0001, t0);
          g.gain.exponentialRampToValueAtTime(0.12, t0 + 0.01);
          g.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.08);
        } else if (type === "ok"){
          o.type = "sine";
          o.frequency.setValueAtTime(660, t0);
          o.frequency.setValueAtTime(880, t0 + 0.07);
          g.gain.setValueAtTime(0.0001, t0);
          g.gain.exponentialRampToValueAtTime(0.16, t0 + 0.01);
          g.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.20);
        } else if (type === "no"){
          o.type = "square";
          o.frequency.setValueAtTime(220, t0);
          o.frequency.exponentialRampToValueAtTime(160, t0 + 0.10);
          g.gain.setValueAtTime(0.0001, t0);
          g.gain.exponentialRampToValueAtTime(0.10, t0 + 0.01);
          g.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.16);
        } else if (type === "whoosh"){
          o.type = "sawtooth";
          o.frequency.setValueAtTime(140, t0);
          o.frequency.exponentialRampToValueAtTime(420, t0 + 0.12);
          g.gain.setValueAtTime(0.0001, t0);
          g.gain.exponentialRampToValueAtTime(0.07, t0 + 0.03);
          g.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.18);
        }

        o.connect(g);
        g.connect(master);
        o.start(t0);
        o.stop(t0 + 0.25);
      }

      // Unlock audio on first user gesture
      const unlock = () => {
        ensureAudio();
        // load user music if exists
        if (!music.src) {
          // Place your file next to index.html with this exact name
          music.src = "je-te-laisserai-des-mots.mp3";
          music.volume = 0.18;
        }
        if (audioEnabled) safePlayMusic();
        window.removeEventListener("pointerdown", unlock, {capture:true});
        window.removeEventListener("touchstart", unlock, {capture:true});
      };
      window.addEventListener("pointerdown", unlock, {capture:true, passive:true});
      window.addEventListener("touchstart", unlock, {capture:true, passive:true});
      setSoundUI();

      /* =======================
         Canvas Particles (hearts/sparks) - lightweight
      ======================= */
      const fx = $("#fx");
      const ctx = fx.getContext("2d", { alpha:true });
      let W=0,H=0,DPR=1;
      const particles = [];
      let fxIntensity = 0.35; // base idle
      let fxBurst = 0;        // burst on final
      let lastT = now();

      function resize(){
        DPR = Math.min(2, window.devicePixelRatio || 1);
        const r = viewport.getBoundingClientRect();
        W = Math.floor(r.width);
        H = Math.floor(r.height);
        fx.width = Math.floor(W * DPR);
        fx.height = Math.floor(H * DPR);
        fx.style.width = W + "px";
        fx.style.height = H + "px";
        ctx.setTransform(DPR,0,0,DPR,0,0);
      }
      window.addEventListener("resize", resize, {passive:true});

      function spawnHeart(x, y, v=1){
        const p = {
          x, y,
          vx: (Math.random()*2-1) * (0.35 + 0.55*v),
          vy: (-0.8 - Math.random()*1.1) * (0.45 + 0.7*v),
          r: 3 + Math.random()*5,
          a: 0.55 + Math.random()*0.35,
          rot: Math.random()*Math.PI*2,
          vr: (Math.random()*2-1)*0.05,
          life: 1.2 + Math.random()*1.2,
          t: 0,
          hue: 350 + Math.random()*25
        };
        particles.push(p);
      }

      function drawHeart(x,y,s,rot,alpha,hue){
        ctx.save();
        ctx.translate(x,y);
        ctx.rotate(rot);
        ctx.globalAlpha = alpha;
        // minimal GPU cost: canvas fill only
        ctx.fillStyle = `hsla(${hue}, 95%, 70%, 1)`;
        ctx.beginPath();
        const k = s/6;
        ctx.moveTo(0, 2*k);
        ctx.bezierCurveTo(0, -2*k, -4*k, -2*k, -4*k, 1*k);
        ctx.bezierCurveTo(-4*k, 4*k, 0, 6*k, 0, 9*k);
        ctx.bezierCurveTo(0, 6*k, 4*k, 4*k, 4*k, 1*k);
        ctx.bezierCurveTo(4*k, -2*k, 0, -2*k, 0, 2*k);
        ctx.closePath();
        ctx.fill();
        ctx.restore();
      }

      function tickParticles(dt){
        // idle spawns
        const target = fxIntensity + (fxBurst>0 ? 0.9 : 0);
        const rate = 10 * target; // per sec
        const count = Math.floor(rate * dt);
        for (let i=0;i<count;i++){
          spawnHeart(Math.random()*W, H*(0.25+Math.random()*0.65), 0.35);
        }
        if (fxBurst>0){
          fxBurst = Math.max(0, fxBurst - dt);
          for (let i=0;i<12;i++){
            spawnHeart(W*0.5 + (Math.random()*120-60), H*0.38 + (Math.random()*120-60), 1.2);
          }
        }

        // update & draw
        ctx.clearRect(0,0,W,H);
        for (let i=particles.length-1;i>=0;i--){
          const p = particles[i];
          p.t += dt;
          const k = p.t / p.life;
          p.vy += 0.03 * dt; // tiny gravity
          p.vx *= (1 - 0.10*dt);
          p.vy *= (1 - 0.10*dt);
          p.x += p.vx * 60 * dt;
          p.y += p.vy * 60 * dt;
          p.rot += p.vr * 60 * dt;
          const alpha = p.a * (1 - k);
          if (k >= 1 || p.y < -60 || p.x < -80 || p.x > W+80){
            particles.splice(i,1);
            continue;
          }
          drawHeart(p.x, p.y, p.r, p.rot, alpha, p.hue);
        }
      }

      function raf(t){
        const dt = Math.min(0.033, (t - lastT)/1000);
        lastT = t;
        tickParticles(dt);
        requestAnimationFrame(raf);
      }

      /* =======================
         Scene management
      ======================= */
      let scene = 1;
      function showScene(n){
        scene = n;
        [s1,s2,s3].forEach((el,i)=>{
          el.classList.toggle("active", (i+1)===n);
        });
      }

      function showToast(text, ms=1400){
        toast.textContent = text;
        toast.classList.add("on");
        clearTimeout(showToast._t);
        showToast._t = setTimeout(()=> toast.classList.remove("on"), ms);
      }

      /* =======================
         Scene 1 logic
      ======================= */
      let refusedOnce = false;

      btnNo.addEventListener("click", () => {
        sfx("no");
        if (!refusedOnce){
          refusedOnce = true;
          courierLine.textContent = "–í—ã —á—Ç–æ, –±–∞–ª–±–µ—Å? –ù–∞ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –ø—Ä–æ—â–∞—é.";
          // remove "–ù–µ—Ç"
          btnNo.classList.add("splitLeft");
          setTimeout(()=>{
            btnNo.style.display="none";
          }, 420);
          showToast("–õ–∞–¥–Ω–æ. –î–∞–≤–∞–π—Ç–µ –µ—â—ë —Ä–∞–∑ üôÇ", 1200);
        }
      }, {passive:true});

      btnYes.addEventListener("click", () => {
        sfx("ok");
        courierLine.textContent = "–û—Ç–ª–∏—á–Ω–æ. –ü–µ—Ä–µ–¥–∞—é –ø–æ—Å—ã–ª–∫—É‚Ä¶";
        // quick ‚Äúhandover‚Äù effect: little whoosh + fade out scene
        sfx("whoosh");
        setTimeout(()=>{
          showScene(2);
          showToast("–ö–æ—Ä–æ–±–∫–∞ –æ—Å—Ç–∞–ª–∞—Å—å —É —Ç–µ–±—è. –ö—Ä—É—Ç–∏ –µ—ë üëÜ", 1400);
        }, 380);
      }, {passive:true});

      /* =======================
         3D Rotation Controller (finger drag + inertia + damping + springy clamp)
      ======================= */
      function makeRotator(elWrap, elObj, options){
        const cfg = Object.assign({
          maxVel: 2.6,     // deg/ms
          damp: 0.92,      // velocity damping per frame
          spring: 0.12,    // clamp spring
          yawLimit: null,  // {min,max} or null
          pitchLimit: {min:-28, max:28},
          startYaw: 18,
          startPitch: -10
        }, options||{});

        let yaw = cfg.startYaw;
        let pitch = cfg.startPitch;
        let vyaw = 0, vpitch = 0;

        let down = false;
        let px=0, py=0;
        let last = 0;

        const state = { yaw, pitch, vyaw, vpitch };

        const apply = () => {
          // GPU-friendly transform only
          elObj.style.transform =
            `translate3d(0,0,0) rotateX(${pitch}deg) rotateY(${yaw}deg)`;
        };

        function onDown(e){
          down = true;
          const p = getPt(e);
          px = p.x; py = p.y;
          last = now();
          // keep velocity (feels physical) but reduce spikes
          vyaw *= 0.65;
          vpitch *= 0.65;
          elWrap.setPointerCapture && e.pointerId != null && elWrap.setPointerCapture(e.pointerId);
        }

        function onMove(e){
          if (!down) return;
          const p = getPt(e);
          const dx = p.x - px;
          const dy = p.y - py;
          px = p.x; py = p.y;

          const t = now();
          const dt = Math.max(1, t - last);
          last = t;

          // sensitivity scaled
          const k = 0.18; // deg per px
          yaw   += dx * k;
          pitch -= dy * k;

          // velocities deg/ms
          vyaw   = clamp((dx * k) / dt, -cfg.maxVel, cfg.maxVel);
          vpitch = clamp((-dy * k) / dt, -cfg.maxVel, cfg.maxVel);

          // clamp softly by spring
          if (cfg.pitchLimit){
            const {min,max} = cfg.pitchLimit;
            if (pitch < min) pitch = lerp(pitch, min, cfg.spring);
            if (pitch > max) pitch = lerp(pitch, max, cfg.spring);
          }
          if (cfg.yawLimit){
            const {min,max} = cfg.yawLimit;
            if (yaw < min) yaw = lerp(yaw, min, cfg.spring);
            if (yaw > max) yaw = lerp(yaw, max, cfg.spring);
          }

          apply();
        }

        function onUp(){
          down = false;
        }

        function getPt(e){
          if (e.touches && e.touches[0]) return {x:e.touches[0].clientX, y:e.touches[0].clientY};
          return {x:e.clientX, y:e.clientY};
        }

        // physics loop
        let running = true;
        let prev = now();
        function loop(){
          if (!running) return;
          const t = now();
          const dt = Math.min(32, t - prev);
          prev = t;

          if (!down){
            // integrate inertia
            yaw   += vyaw * dt;
            pitch += vpitch * dt;

            // damping
            vyaw   *= Math.pow(cfg.damp, dt/16.6);
            vpitch *= Math.pow(cfg.damp, dt/16.6);

            // soft clamp with spring
            if (cfg.pitchLimit){
              const {min,max} = cfg.pitchLimit;
              if (pitch < min){ const d = (min - pitch); vpitch += d * 0.004 * dt; pitch = lerp(pitch, min, cfg.spring*0.7); }
              if (pitch > max){ const d = (max - pitch); vpitch += d * 0.004 * dt; pitch = lerp(pitch, max, cfg.spring*0.7); }
            }
            if (cfg.yawLimit){
              const {min,max} = cfg.yawLimit;
              if (yaw < min){ const d = (min - yaw); vyaw += d * 0.004 * dt; yaw = lerp(yaw, min, cfg.spring*0.7); }
              if (yaw > max){ const d = (max - yaw); vyaw += d * 0.004 * dt; yaw = lerp(yaw, max, cfg.spring*0.7); }
            }
            // stop micro drift
            if (Math.abs(vyaw) < 0.0002) vyaw = 0;
            if (Math.abs(vpitch) < 0.0002) vpitch = 0;

            apply();
          }
          requestAnimationFrame(loop);
        }

        elWrap.addEventListener("pointerdown", onDown, {passive:true});
        elWrap.addEventListener("pointermove", onMove, {passive:true});
        elWrap.addEventListener("pointerup", onUp, {passive:true});
        elWrap.addEventListener("pointercancel", onUp, {passive:true});
        // fallback touch
        elWrap.addEventListener("touchstart", onDown, {passive:true});
        elWrap.addEventListener("touchmove", onMove, {passive:true});
        elWrap.addEventListener("touchend", onUp, {passive:true});

        apply();
        requestAnimationFrame(loop);

        return {
          get yaw(){ return yaw; },
          get pitch(){ return pitch; },
          set yaw(v){ yaw=v; apply(); },
          set pitch(v){ pitch=v; apply(); },
          stop(){ running=false; }
        };
      }

      const boxRot = makeRotator(boxWrap, boxObj, { startYaw: 18, startPitch: -10, pitchLimit:{min:-26,max:26} });
      const envRot = makeRotator(envWrap, envObj, { startYaw: -16, startPitch: -8, pitchLimit:{min:-24,max:24} });

      /* =======================
         Code Lock Wheels
      ======================= */
      const months = ["—è–Ω–≤–∞—Ä—è","—Ñ–µ–≤—Ä–∞–ª—è","–º–∞—Ä—Ç–∞","–∞–ø—Ä–µ–ª—è","–º–∞—è","–∏—é–Ω—è","–∏—é–ª—è","–∞–≤–≥—É—Å—Ç–∞","—Å–µ–Ω—Ç—è–±—Ä—è","–æ–∫—Ç—è–±—Ä—è","–Ω–æ—è–±—Ä—è","–¥–µ–∫–∞–±—Ä—è"];
      const dayVals = Array.from({length:31}, (_,i)=> String(i+1));
      const yearVals = ["2024","2025","2026"]; // keep small, easier
      const correct = { day:"5", month:"–Ω–æ—è–±—Ä—è", year:"2025" };

      const wheelState = {
        day: { idx: 4, items: dayVals },
        month: { idx: 10, items: months },
        year: { idx: 1, items: yearVals }
      };

      function buildWheel(wheelEl, type){
        const list = $(".list", wheelEl);
        list.innerHTML = "";
        const items = wheelState[type].items;

        // render 9 items around center via looping (lightweight)
        for (let i=0;i<items.length;i++){
          const div = document.createElement("div");
          div.className = "item";
          div.textContent = items[i];
          list.appendChild(div);
        }
        updateWheel(type);
      }

      function updateWheel(type){
        const wheelEl = $(`.wheel[data-wheel="${type}"]`, wheelsEl);
        const list = $(".list", wheelEl);
        const idx = wheelState[type].idx;
        const items = $$(".item", list);

        // highlight
        items.forEach((it,i)=> it.classList.toggle("active", i===idx));

        // translate so active is centered
        const itemH = 56;
        const y = -idx * itemH;
        list.style.transform = `translate3d(0, ${y}px, 0)`;
      }

      function bumpWheel(type, dir){
        const st = wheelState[type];
        st.idx = (st.idx + dir + st.items.length) % st.items.length;
        updateWheel(type);
      }

      function attachWheelInput(type){
        const wheelEl = $(`.wheel[data-wheel="${type}"]`, wheelsEl);
        let startY=0, acc=0, active=false;
        let lastT=0, vel=0;

        const onDown = (e) => {
          active = true;
          const p = pt(e);
          startY = p.y;
          acc = 0;
          vel = 0;
          lastT = now();
          wheelEl.setPointerCapture && e.pointerId != null && wheelEl.setPointerCapture(e.pointerId);
        };

        const onMove = (e) => {
          if (!active) return;
          const p = pt(e);
          const dy = p.y - startY;
          startY = p.y;

          const t = now();
          const dt = Math.max(1, t - lastT);
          lastT = t;
          vel = dy / dt; // px/ms

          acc += dy;
          // step when passed threshold
          const step = 34;
          while (acc > step){
            acc -= step;
            bumpWheel(type, -1); // swipe down => previous (upwards)
            sfx("tap");
          }
          while (acc < -step){
            acc += step;
            bumpWheel(type, +1);
            sfx("tap");
          }
        };

        const onUp = () => {
          if (!active) return;
          active = false;
          // tiny inertial extra step
          if (Math.abs(vel) > 0.6){
            bumpWheel(type, vel > 0 ? -1 : +1);
          }
        };

        const pt = (e) => {
          if (e.touches && e.touches[0]) return {x:e.touches[0].clientX, y:e.touches[0].clientY};
          return {x:e.clientX, y:e.clientY};
        };

        wheelEl.addEventListener("pointerdown", onDown, {passive:true});
        wheelEl.addEventListener("pointermove", onMove, {passive:true});
        wheelEl.addEventListener("pointerup", onUp, {passive:true});
        wheelEl.addEventListener("pointercancel", onUp, {passive:true});
        wheelEl.addEventListener("touchstart", onDown, {passive:true});
        wheelEl.addEventListener("touchmove", onMove, {passive:true});
        wheelEl.addEventListener("touchend", onUp, {passive:true});
      }

      // init wheels
      $$(".wheel", wheelsEl).forEach(w => buildWheel(w, w.dataset.wheel));
      attachWheelInput("day");
      attachWheelInput("month");
      attachWheelInput("year");

      function openCode(){
        sfx("tap");
        codeOverlay.classList.add("on");
      }
      function closeCodeModal(){
        sfx("tap");
        codeOverlay.classList.remove("on");
      }

      lock.addEventListener("click", (e) => {
        e.stopPropagation();
        openCode();
      });

      closeCode.addEventListener("click", closeCodeModal);
      backFromCode.addEventListener("click", closeCodeModal);

      doneCode.addEventListener("click", () => {
        const cur = {
          day: wheelState.day.items[wheelState.day.idx],
          month: wheelState.month.items[wheelState.month.idx],
          year: wheelState.year.items[wheelState.year.idx]
        };
        if (cur.day === correct.day && cur.month === correct.month && cur.year === correct.year){
          sfx("ok");
          // lock click + open box -> go scene 3
          closeCodeModal();
          lock.classList.add("shake");
          setTimeout(()=> lock.classList.remove("shake"), 420);

          showToast("–©—ë–ª–∫! –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è‚Ä¶", 1200);
          fxBurst = 0.35;
          // small opening illusion: rotate box forward then fade
          const startYaw = boxRot.yaw, startPitch = boxRot.pitch;
          const t0 = now();
          const dur = 520;

          const anim = () => {
            const t = now();
            const p = clamp((t - t0)/dur, 0, 1);
            const ease = p<.5 ? 2*p*p : 1 - Math.pow(-2*p+2,2)/2;
            boxRot.yaw = lerp(startYaw, startYaw + 22, ease);
            boxRot.pitch = lerp(startPitch, startPitch - 10, ease);
            if (p < 1) requestAnimationFrame(anim);
          };
          requestAnimationFrame(anim);

          setTimeout(()=>{
            showScene(3);
            showToast("–í–Ω—É—Ç—Ä–∏ –±—ã–ª –∫–æ–Ω–≤–µ—Ä—Ç üíå", 1400);
          }, 650);
        } else {
          sfx("no");
          // shake sheet
          const sh = $(".sheet", codeOverlay);
          sh.classList.remove("shake");
          void sh.offsetWidth;
          sh.classList.add("shake");
          showToast("–ù–µ–≤–µ—Ä–Ω–æ üôÇ –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë", 1100);
        }
      });

      /* =======================
         Scene 3 logic
      ======================= */
      let threwOnce = false;
      let openMode = "choice"; // "choice" -> "birth" -> "final"

      throwBtn.addEventListener("click", () => {
        sfx("no");
        if (!threwOnce){
          threwOnce = true;

          // shake everything slightly
          envWrap.classList.add("shake");
          setTimeout(()=> envWrap.classList.remove("shake"), 420);

          showToast("–©–∞—Å –ø–æ —à–µ–µ –ø–æ–ª—É—á–∏—à—å", 1200);

          // remove throw button with left slide, open expands
          throwBtn.classList.add("splitLeft");
          openBtn.classList.add("expandRight");
          setTimeout(()=>{
            throwBtn.style.display="none";
          }, 420);
        } else {
          showToast("–ù—É –≤—Å—ë, —É–∂–µ –ø–æ–∑–¥–Ω–æ üòå", 900);
        }
      });

      openBtn.addEventListener("click", () => {
        sfx("tap");
        if (openMode === "choice"){
          openMode = "birth";
          // zoom-in feel: make seal more prominent
          sealPulse.style.opacity = "1";
          birthBlock.style.display = "block";
          $("#envHint").textContent = "–°–Ω–∞—á–∞–ª–∞ –º–∞–ª–µ–Ω—å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å üôÇ";
          // micro ‚Äúcamera‚Äù effect (transform on wrap)
          envWrap.style.transition = "transform 420ms cubic-bezier(.22,1,.2,1)";
          envWrap.style.transform = "scale(1.04)";
          setTimeout(()=> envWrap.style.transform = "scale(1)", 520);
          birthInput.focus({preventScroll:true});
        }
      });

      function normalizeDate(s){
        // accept "1.2.2005" or "01-02-2005" -> "01.02.2005"
        const m = s.replace(/[^\d]/g, "");
        if (m.length < 8) return null;
        const d = m.slice(0,2);
        const mo = m.slice(2,4);
        const y = m.slice(4,8);
        return `${d}.${mo}.${y}`;
      }

      function checkBirth(){
        const v = normalizeDate(birthInput.value || "");
        if (!v){
          sfx("no");
          birthHint.textContent = "–§–æ—Ä–º–∞—Ç: 01.02.2005 üôÇ";
          seal.classList.add("shake");
          setTimeout(()=> seal.classList.remove("shake"), 420);
          return;
        }
        if (v === "01.02.2005"){
          sfx("ok");
          birthHint.textContent = "";
          // seal falls/peels + flap opens
          fxBurst = 0.8;
          showToast("–í–µ—Ä–Ω–æ üíó", 1000);

          seal.style.transition = "transform 520ms cubic-bezier(.22,1,.2,1), opacity 520ms ease";
          seal.style.transform = "translate3d(-50%, 10%, 60px) rotateZ(-12deg)";
          seal.style.opacity = "0.15";

          envFlap.style.transition = "transform 640ms cubic-bezier(.22,1,.2,1)";
          envFlap.style.transform = "translate3d(-50%,-50%,41px) rotateX(-70deg)";

          setTimeout(()=>{
            openMode = "final";
            envBtns.style.display = "none";
            birthBlock.style.display = "none";
            $("#envHint").textContent = "–ü–∏—Å—å–º–æ –≤–Ω—É—Ç—Ä–∏‚Ä¶";
            // reveal final block
            finalBlock.style.display = "flex";
            finalBlock.classList.add("pop");

            startGallery();
            // calmer background particles after fireworks
            setTimeout(()=> { fxBurst = 0; fxIntensity = 0.28; }, 1200);
          }, 720);
        } else {
          sfx("no");
          // soft hint
          birthHint.textContent = "–ü–æ—á—Ç–∏. –ü–æ–¥—É–º–∞–π –æ —Ñ–µ–≤—Ä–∞–ª–µ üôÇ";
          seal.classList.add("shake");
          setTimeout(()=> seal.classList.remove("shake"), 420);
        }
      }

      birthOk.addEventListener("click", checkBirth);
      birthInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") checkBirth();
      });

      /* =======================
         Gallery logic (3‚Äì4 photos) with preload + fade
      ======================= */
      let gallery = { list: [], idx: 0, timer: null };

      function addDot(n){
        gDots.innerHTML = "";
        for (let i=0;i<n;i++){
          const d = document.createElement("div");
          d.className = "gdot" + (i===0 ? " on":"");
          gDots.appendChild(d);
        }
      }
      function setDot(i){
        $$(".gdot", gDots).forEach((d,idx)=> d.classList.toggle("on", idx===i));
      }

      function setGalleryImage(i){
        const item = gallery.list[i];
        if (!item) return;
        gImg.classList.remove("on");
        // swap src after a frame for nicer fade
        requestAnimationFrame(()=>{
          gImg.src = item.src;
          gImg.onload = () => {
            requestAnimationFrame(()=> gImg.classList.add("on"));
          };
          gCap.textContent = item.cap;
          setDot(i);
        });
      }

      function startGallery(){
        addDot(gallery.list.length);
        gallery.idx = 0;
        setGalleryImage(0);

        clearInterval(gallery.timer);
        gallery.timer = setInterval(()=>{
          gallery.idx = (gallery.idx + 1) % gallery.list.length;
          setGalleryImage(gallery.idx);
        }, 2800);
      }

      /* =======================
         Preload images (with fallback hearts)
      ======================= */
      function loadImg(src){
        return new Promise((resolve) => {
          const im = new Image();
          im.decoding = "async";
          im.loading = "eager";
          im.onload = () => resolve({ ok:true, src });
          im.onerror = () => resolve({ ok:false, src });
          im.src = src;
        });
      }

      async function preload(){
        resize();
        requestAnimationFrame(raf);

        // try to load candidates; take first 4 that exist
        const results = [];
        let tried = 0;
        for (const c of photoCandidates){
          tried++;
          const r = await loadImg(c);
          if (r.ok) results.push(r.src);
          // progress: up to ~70% by image scan
          const pct = Math.floor(clamp((tried / photoCandidates.length) * 70, 5, 70));
          bar.style.width = pct + "%";
          if (results.length >= 4) break;
        }

        // choose 3‚Äì4 final images (fallback if none)
        const finalImgs = results.length ? results.slice(0,4) : [FALLBACK("‚ù§"), FALLBACK("üíó"), FALLBACK("üíû"), FALLBACK("‚ù§")];

        // ensure at least 3
        const pick = finalImgs.slice(0, Math.max(3, Math.min(4, finalImgs.length)));

        gallery.list = pick.map((src, i) => ({
          src,
          cap: captions[i % captions.length]
        }));

        // preload chosen
        for (let i=0;i<pick.length;i++){
          await loadImg(pick[i]);
          const pct = 70 + Math.floor(((i+1)/pick.length)*25);
          bar.style.width = pct + "%";
        }

        // "UI ready"
        bar.style.width = "100%";
        await new Promise(r=>setTimeout(r, 220));
      }

      /* =======================
         Start
      ======================= */
      preload().then(() => {
        // Fade in app
        pre.style.opacity = "0";
        pre.style.transition = "opacity 260ms ease";
        setTimeout(()=> pre.style.display="none", 280);

        app.style.opacity = "1";

        // keep base particles gentle
        fxIntensity = 0.34;

        // set initial UI
        showScene(1);

        // tiny welcome
        setTimeout(()=> showToast("–° –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º üíå", 1100), 380);

      }).catch(() => {
        // even if something breaks, do not block
        pre.style.display="none";
        app.style.opacity = "1";
      });

      /* =======================
         Prevent scroll / overscroll glow inside TG webview
      ======================= */
      document.addEventListener("touchmove", (e) => {
        // only prevent when touching inside viewport to avoid rubber band
        if (viewport.contains(e.target)) e.preventDefault();
      }, {passive:false});

      /* =======================
         Small tap SFX for primary buttons (optional)
      ======================= */
      $$(".btn").forEach(b=>{
        b.addEventListener("click", () => {
          if (!b.classList.contains("primary")) return;
          sfx("tap");
        }, {passive:true});
      });

      // Also allow clicking seal (no action besides hint)
      seal.addEventListener("click", () => {
        if (openMode === "birth"){
          birthInput.focus({preventScroll:true});
          showToast("–í–≤–µ–¥–∏ –¥–∞—Ç—É üôÇ", 900);
          sfx("tap");
        }
      });

    })();
  </script>
</body>
</html>
